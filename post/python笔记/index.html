<!DOCTYPE html>
<html lang="zh-Hans">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="王笑涵">

  
  
  
    
  
  <meta name="description" content="@[toc] 列表生成器 使用列表生成器可以简便的产生列表，省去for 注意，python3 对其中num变量视作局部变量，而python2则不是，这会影响其">

  
  <link rel="alternate" hreflang="en" href="https://leidawt.github.io/en/post/python%E7%AC%94%E8%AE%B0/">
  
  <link rel="alternate" hreflang="zh-Hans" href="https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158088555-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-158088555-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Academic">
  <meta property="og:url" content="https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/">
  <meta property="og:title" content="python笔记 | Academic">
  <meta property="og:description" content="@[toc] 列表生成器 使用列表生成器可以简便的产生列表，省去for 注意，python3 对其中num变量视作局部变量，而python2则不是，这会影响其"><meta property="og:image" content="img/map[gravatar:%!s(bool=false) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=false) shape:circle]"><meta property="og:locale" content="zh-Hans">
  
    
      <meta property="article:published_time" content="2018-09-26T12:00:00&#43;08:00">
    
    <meta property="article:modified_time" content="2018-09-26T12:00:00&#43;08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/"
  },
  "headline": "python笔记",
  
  "datePublished": "2018-09-26T12:00:00+08:00",
  "dateModified": "2018-09-26T12:00:00+08:00",
  
  "author": {
    "@type": "Person",
    "name": "王笑涵"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Academic",
    "logo": {
      "@type": "ImageObject",
      "url": "img/https://leidawt.github.io/"
    }
  },
  "description": "@[toc] 列表生成器 使用列表生成器可以简便的产生列表，省去for 注意，python3 对其中num变量视作局部变量，而python2则不是，这会影响其"
}
</script>

  

  


  


  





  <title>python笔记 | Academic</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>搜索</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Academic</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="切换导航">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Academic</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>主页</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>文章</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>项目</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>论文</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>联系我</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>教程</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown i18n-dropdown">
        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-globe mr-1" aria-hidden="true"></i><span class="d-none d-lg-inline">中文 (简体)</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-item i18n-active font-weight-bold">
            <span>中文 (简体)</span>
          </div>
          
          <a class="dropdown-item" href="https://leidawt.github.io/en/post/python%E7%AC%94%E8%AE%B0/">
            <span>English</span>
          </a>
          
        </div>
      </li>
      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>python笔记</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    



  
  <span><a href="/authors/admin/">王笑涵</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Sep 26, 2018
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 分钟阅读时长
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>@[toc]</p>
<h3 id="列表生成器">列表生成器</h3>
<p>使用列表生成器可以简便的产生列表，省去for
注意，python3 对其中num变量视作局部变量，而python2则不是，这会影响其上下文的同名变量值！！！
列表生成器和列表推导几乎替代了map reduce filter等高阶函数的绝大多数功能，一般不再使用高阶函数和匿名函数</p>
<pre><code class="language-python">l = [num*2 for num in range(1, 5)]
print(l)
#[2, 4, 6, 8]
la = [1, 2]
lb = [4, 5, 6]
l = [Point(a, b) for a in la for b in lb]
#[Point(x=1, y=4), Point(x=1, y=5), Point(x=1, y=6), Point(x=2, y=4), Point(x=2, y=5), Point(x=2, y=6)]
</code></pre>
<h3 id="生成器generator">生成器generator</h3>
<p>语法与列表生成器类似，仅改为（）。区别在于不一次性计算出列表，二是返回一个可迭代对象generator object，这是可迭代的，可以直接送入max,sum等函数</p>
<pre><code class="language-python">def a(i):
    return i*2
def b(i):
    return i*3
l = [a, b]
print(list(each(10) for each in l))#[20,30]
print(max(each(10) for each in l))#30
</code></pre>
<h3 id="列表推导">列表推导</h3>
<p>对于过滤等操作很方便</p>
<pre><code class="language-python">symbols = '$¢£¥€¤'
beyond_ascii = [ord(s) for s in symbols if ord(s) &gt; 127]
#[162, 163, 165, 8364, 164]
beyond_ascii = list(filter(lambda c: c &gt; 127, map(ord, symbols)))
#[162, 163, 165, 8364, 164]
</code></pre>
<h3 id="运算符类与map_reduce">运算符类与map_reduce</h3>
<p>尽管列表推导，生成器代替了绝大多数map_reduce应用，仍有些时候会用到。如计算hash值时需要将一系列值异或起来，如下。
其中operator类提供了所有运算符，避免写lambda函数</p>
<pre><code class="language-python">import functools
import operator
def hash_all(h):
	hashes = (hash(x) for x in h) # 这里做一个可迭代的生成器
	return functools.reduce(operator.xor, hashes, 0)
	#调用运算符类和reduce算法计算h中所有元素相异或的值
</code></pre>
<h3 id="namedtuple命名元组">namedtuple命名元组</h3>
<p>用于方便的构建仅有几个属性的类，生成的namedtuple可以像类一样引用其属性，如下namedtuple用于表示平面点坐标</p>
<pre><code class="language-python">import collections
Point = collections.namedtuple('Point', ['x', 'y'])
p1 = Point(1, 2)
p2 = Point(3, 4)
print(p1.x)
</code></pre>
<h3 id="元组">元组</h3>
<pre><code class="language-python">t=(a,b)
first,second=t#拆包
print(t[0])
a, b, *rest = range(5)#平行赋值，多余的存成列表赋给rest
#嵌套的
a=(1,2,(1,2))
q,w,e=a
#q=1 w=2 e=(1,2)
</code></pre>
<h3 id="切片">切片</h3>
<p>切片的下标逻辑如下，在索引前切开





  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/0_hu4bdd234932630a94cb7e5eca49157f44_25390_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/0_hu4bdd234932630a94cb7e5eca49157f44_25390_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="402" height="239">
</a>



</figure>

还可以用如下的形式对 s 在 a 和 b之间以 c 为间隔取值。c 的值还可以为负





  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/1_hubbbbbeeb591afe60f7b9336f786d2f04_10783_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/1_hubbbbbeeb591afe60f7b9336f786d2f04_10783_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="238" height="217">
</a>



</figure>

借助切片可方便的赋值





  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/2_hu5ae35b869cd18ab5b88facef67c94e8f_41151_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/2_hu5ae35b869cd18ab5b88facef67c94e8f_41151_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="467" height="438">
</a>



</figure>
</p>
<h3 id="排序与插入">排序与插入</h3>
<pre><code class="language-python">fruits = ['grape', 'raspberry', 'apple', 'banana']
#一般排序，原列表并没有变化，返回排好的
print(sorted(fruits))
#传入排序依据函数
print(sorted(fruits, key=len))
fruits.sort()#就地排序


import bisect
import random
random.seed(1729)#输入随机种子
my_list = [random.randrange(1, 10) for each in range(10)]#生成0-9随机类列表
print(my_list)
my_list.sort()#就地排序
bisect.insort(my_list, 3)#按顺序插入（二分）
print(my_list)
</code></pre>
<h3 id="数组">数组</h3>
<p>接近c数组，可降低list开销</p>
<pre><code class="language-python">from array import array
from random import random
floats = array('d', (random() for i in range(100)))#‘d’用于指出存储类型
fp = open('floats.bin', 'wb')
floats.tofile(fp)#可输出为二进制
fp.close()
floats2 = array('d')
fp = open('floats.bin', 'rb')
floats2.fromfile(fp, 100)#可从二进制输入
print(floats[0])#可如列表一样引用
</code></pre>
<h3 id="dict">DICT</h3>
<pre><code class="language-python">a = ['a', 'b', 'c']
b = [1, 2, 3]
d = zip(a, b)#返回zip对象，可迭代出(a,b)
dic = dict(d)
print(dic['a'])
dicc=dic


#只读DICT
from types import MappingProxyType
d = {1:'A'}
d_proxy=MappingProxyType(d)
print(d_proxy[1])#只读，不可修改
d[2]='B'
#之后d_proxy会同步更新
</code></pre>
<h3 id="set">SET</h3>
<p>set是无重复集。与数学上的集合相似，可进行集合运算</p>
<pre><code class="language-python">a = [1, 2, 3, 3]
b = [2, 3, 4]
sa = set(a)
sb = set(b)
print(sa | sb)
print(sa-sb)
print(sa &amp; sb)
print(sa ^ sb)#求差集
#另有子集，包含等判断
</code></pre>
<h3 id="函数">函数</h3>
<p>这是一个例子，其中
第一个参数后面的任意个参数会被 *content 捕获，存入一个元组
tag 函数签名中没有明确指定名称的关键字参数会被 **attrs 捕
获，存入一个字典。
cls 参数只能作为关键字参数传入。</p>
<pre><code class="language-python">def tag(name, *content, cls=None, **attrs):
	&quot;&quot;&quot;生成一个或多个HTML标签&quot;&quot;&quot;
	if cls is not None:
		attrs['class'] = cls
	if attrs:
		attr_str = ''.join(' %s=&quot;%s&quot;' % (attr, value)
		for attr, value
		in sorted(attrs.items()))
	else:
		attr_str = ''
	if content:
		return '\n'.join('&lt;%s%s&gt;%s&lt;/%s&gt;' %
		(name, attr_str, c, name) for c in content)
	else:
		return '&lt;%s%s /&gt;' % (name, attr_str)
</code></pre>
<h3 id="函数内省">函数内省</h3>
<p>在计算机编程中，自省是指这种能力：检查某些事物以确定它是什么、它知道什么以及它能做什么。即当你拿到一个“函数对象”的时候，你可以继续知道，它的名字，参数定义状况等信息。python关于参数信息存放在函数的特殊属性中，时实际不方便使用，借助inspect包可很好处理
内省常用于检查传入的函数是否符合要求</p>
<pre><code class="language-python">from inspect import signature


def myfun(a, b=1, *c):
    pass


sig = signature(myfun)
print(sig)
for name, param in sig.parameters.items():
    print(param.kind, ':', name, '=', param.default)
</code></pre>
<p>其中kind有五种
POSITIONAL_OR_KEYWORD
　　可以通过定位参数和关键字参数传入的形参（多数 Python 函数的参
数属于此类）。
VAR_POSITIONAL
　　定位参数元组。
VAR_KEYWORD
　　关键字参数字典。
KEYWORD_ONLY
　　仅限关键字参数（Python 3 新增）。
POSITIONAL_ONLY
　　仅限定位参数；目前，Python 声明函数的句法不支持，但是有些使
用 C 语言实现且不接受关键字参数的函数（如 divmod）支持。</p>
<h3 id="函数注解">函数注解</h3>
<p>python3重要的新特性，用于为函数声明中的参数和返回值附加元数据</p>
<pre><code class="language-python">def clip(text:str, max_len:'int &gt; 0'=80) -&gt; str: ➊
	&quot;&quot;&quot;在max_len前面或后面的第一个空格处截断文本
	&quot;&quot;&quot;
	end = None
	if len(text) &gt; max_len:
		space_before = text.rfind(' ', 0, max_len)
	if space_before &gt;= 0:
		end = space_before
	else:
		space_after = text.rfind(' ', max_len)
	if space_after &gt;= 0:
		end = space_after
	if end is None: # 没找到空格
		end = len(text)
	return text[:end].rstrip()
</code></pre>
<p>函数声明中的各个参数可以在 : 之后增加注解表达式。如果参数有默认值，注解放在参数名和 = 号之间。如果想注解返回值，在 ) 和函数声明末尾的 : 之间添加 -&gt; 和一个表达式。那个表达式可以是任何类型。注解中最常用的类型是类（如 str 或 int）和字符串（如 &lsquo;int &gt;0&rsquo;）。在示例 5-19 中，max_len 参数的注解用的是字符串。python 对注解所做的唯一的事情是，把它们存储在函数的__annotations__ 属性里
print(signature(f).parameters.values())
可调出属性</p>
<h3 id="abc抽象方法">ABC抽象方法</h3>
<p>python本身不提供抽象方法，可用ABC类来辅助检查</p>
<pre><code class="language-python">from abc import ABC, abstractmethod


class Base(ABC):

    @abstractmethod
    def load(self, input):
        &quot;&quot;&quot;Retrieve data from the input source and return an object.&quot;&quot;&quot;
        return


class A(Base):
    def load(self, input):
        print(input)


class B(Base):
    pass


a = A()
b = B()#err
</code></pre>
<h3 id="变量作用域闭包">变量作用域&amp;闭包</h3>
<p>Python 编译函数的定义体时，默认吧内部变量看做局部变量，若实则指全局，需要显示的声明 global xxx</p>
<p>闭包指延伸了作用域的函数，其中包含函数定义体中引用、但是不在定义体中定义的非全局变量,如</p>
<pre><code class="language-python">def make_averager():
	series = []
	def averager(new_value):
		series.append(new_value)
		total = sum(series)
		return total/len(series)
	return averager
</code></pre>
<p>这个函数返回avr函数，其中使用了series存储历史值
当make_averager返回时，它会保留定义函数时存在的自由变量的绑定（此处的series），这样调用函数时，虽然定义作用域不可用了，但是仍能使用那些绑定！</p>
<p>通过使用nonlocal关键字，可不用列表实现上述函数（这样可正确闭包，否则解释器会将count,total视作局部变量，不加以闭包绑定）</p>
<pre><code class="language-python">def make_averager():
	count = 0
	total = 0
	def averager(new_value):
		nonlocal count, total
		count += 1
		total += new_value
		return total / count
	return averager
</code></pre>
<h3 id="装饰器">装饰器</h3>
<p>装饰器的一大特性是，能把被装饰的函数替换成其他函数。第二个特性是，装饰器在加载模块时立即执行。（函数装饰器在导入模块时立即执行，而被装饰的函数只在明确调用时运行）
<strong>装饰器的典型行为</strong>：把被装饰的函数替换成新函数，二者接受相同的参数，而且（通常）返回被装饰的函数本该返回的值，同时还会做些额外操作。
比如可借助装饰器帮助注册函数到列表
<strong>叠放</strong>：越靠近函数的先起装饰作用</p>
<pre><code class="language-python">fun_list = []


def isfun(fun):
    fun_list.append(fun)
    return fun


@isfun
def a(i):
    return i*2


@isfun
def b(i):
    return i*3


print(fun_list)
#[&lt;function a at 0x0000000000C2EEA0&gt;, &lt;function b at 0x0000000000C2EF28&gt;]
</code></pre>
<p>为更好的处理传入函数的参数和特殊属性等，最佳实践是利用functools 中wraps来辅助构建，如下的例子实现了执行时间测试功能，注意传参的处理</p>
<pre><code class="language-python">import time
from functools import wraps


def clock(func):
    @wraps(func)
    def clocked(*args, **kwargs):
        t0 = time.time()
        result = func(*args, **kwargs)
        elapsed = time.time() - t0
        name = func.__name__
        arg_lst = []
        if args:
            arg_lst.append(', '.join(repr(arg) for arg in args))
        if kwargs:
            pairs = ['%s=%r' % (k, w) for k, w in sorted(kwargs.items())]
            arg_lst.append(', '.join(pairs))
        arg_str = ', '.join(arg_lst)
        print('[%0.8fs] %s(%s) -&gt; %r ' % (elapsed, name, arg_str, result))
        return result
    return clocked


@clock
def fun(a, b, **c):
    print('a=', a, 'b=', b)
    print(c)


fun(1, 2, x=1, y=2)
print(fun.__name__)  # 不改变名称

</code></pre>
<p>标准库内置了几个很有用的装饰器
<strong>1.</strong>
import functools
@functools.lru_cache()
作用是用缓存优化递归算法（通过保存调用结果），此外lru_cache 在从 Web 中获取信息的应用中也能发挥巨大作用。
可接受参数
functools.lru_cache(maxsize=128, typed=False)
maxsize 参数指定存储多少个调用的结果
typed 参数如果设为 True，把不同参数类型得到的结果分开保存
被 lru_cache 装饰的函数会有 cache_clear 和 cache_info 两个方法，分别用于清除缓存和查看缓存信息。
<strong>2</strong>
@classmethod
用于将方法变成java中静态方法的概念，即不必生成实例即可调用</p>
<pre><code class="language-python">    @classmethod
    def pargs(self, *args):
        print(*args)
</code></pre>
<h3 id="python思维-鸭子类型">python思维-鸭子类型</h3>
<p>“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子。”
在python的思维中，我们并不关心对象是什么类型，到底是不是鸭子，只关心行为，这一点是和java完全不同的。如下的例子，可见所谓鸭子类型对多态特性的轻巧实现。同样的python提供的大量特殊方法（magic method）也应用了这一思想，如任何实现了 __iter__ 和 __next__方法的对象都可称之为迭代器，而任何类只要实现__getitem__方法，那python的解释器就会把它当做一个collection</p>
<pre><code class="language-python">class Duck:
    def quack(self):
        print &quot;Quaaaaaack!&quot;
 
class Bird:
    def quack(self):
        print &quot;bird imitate duck.&quot;
 
class Doge:
    def quack(self):
        print &quot;doge imitate duck.&quot;
 
def in_the_forest(duck):
    duck.quack()
 
duck = Duck()
bird = Bird()
doge = Doge()
for x in [duck, bird, doge]:
    in_the_forest(x)

</code></pre>
<h3 id="对象的一些问题">对象的一些问题</h3>
<p>首先一些概念声明
<strong>==与is</strong>
== 运算符比较两个对象的值（对象中保存的数据），而 is 比较对象的
标识。可以在自己的类中定义 __eq__ 方法，决定 == 如何比较实例。如果不覆盖 __eq__ 方法，那么从 object 继承的方法比较对象的 ID
<strong>浅复制</strong>
如下，只复制浅层，子列表仍指向相同的内存</p>
<pre><code class="language-python">l1 = [1, 2, [1, 2]]
l2 = list(l1)
print(id(l1) == id(l2))#flase
print(id(l1[-1]) == id(l2[-1]))#true
</code></pre>
<p>若要深复制，使用copy包的deepcopy函数
<strong>传参</strong>
python传参全部为传引用
这会导致一个不易察觉的问题，即在类中函数用可变对象作为函数的默认参数时，可能会导致多个实例引用到同一个内存上，导致错误。</p>
<h3 id="class常用特殊方法">class常用特殊方法</h3>
<p>特殊方法的使用可使类更符合python的思维，便于接入python的str,sum,==迭代，散列等优秀特性。如下面的类</p>
<pre><code class="language-python">class Test:
    a = 0
    b = None

    def __init__(self, a, b=None):
        self.a = a
        self.b = b
    # 用于被str()方法调用

    def __str__(self):
        return '__str__ method'
    # 调试信息

    def __repr__(self):
        return '__repr__ method'
    # 用于==运算符

    def __eq__(self, other):
        #print(self.a, other.a)
        return self.a == other.a
    # 定义散列函数，使得可用set

    def __hash__(self):
        return hash(self.a)
    # 迭代。这里返回b的生成器

    def __iter__(self):
        return (each for each in self.b)
    # 使得实例可用len()

    def __len__(self):
        return len(self.b) if self.b is not None else 0
    # 这是声明了静态方法

    @classmethod
    def pargs(self, *args):
        print(*args)

</code></pre>
<p>另外实现如下的两个特殊方法可实现序列属性，可以实现切片和迭代特性，并可实现[] 访问</p>
<pre><code class="language-python">class Test:
    _components = []

    def __init__(self, l):
        self._components = l

    def __len__(self):
        return len(self._components)

    def __getitem__(self, index):
        return self._components[index]


t = Test([1, 2, 3])
print(t[0])
for each in t:
    print(each)
</code></pre>
<p>全部特殊方法：
<strong>流畅的python.pdf-p57</strong></p>
<h3 id="异常">异常</h3>
<p>通过捕获异常可以避免脚本直接退出
典型异常处理如下</p>
<pre><code class="language-python">try:
    fh = open(&quot;testfile&quot;, &quot;w&quot;)
    fh.write(&quot;hello world!!&quot;)
except IOError:
	#捕获IOError错误
    print(&quot;Error: open fail&quot;)
else:
	#不发生异常时执行，和try是一对
    print(&quot;success!&quot;)
    fh.close()
</code></pre>
<p>python定义好的标准异常有如下这些
<a href="http://www.runoob.com/python/python-exceptions.html">http://www.runoob.com/python/python-exceptions.html</a>
可如下发起异常</p>
<pre><code class="language-python">raise Exception(&quot;Invalid level!&quot;)
</code></pre>
<p>或raise其他标准异常，通常不必自定义异常类</p>
<h3 id="封包与import">封包与import</h3>
<p><strong>from…import 与 import</strong>
区别在于import的要用 <strong>模块名.函数名</strong> 来调用，而前者直接用函数名即可。import机制会自动处理重复引用问题，无需多虑
<strong>包</strong>
包就是文件夹，只要该文件夹下存在 __init__.py 文件。
<a href="http://www.runoob.com/python/python-modules.html">http://www.runoob.com/python/python-modules.html</a>
一般简单的多文件项目不必使用包，直接<strong>import 文件名</strong>即可引入</p>
<h3 id="单元测试">单元测试</h3>
<p>使用内置unittest进行
需要import unittest并在测试文件里创建一个测试类。测试文件采用 被测文件名_test.py命名。测试类继承unittest.TestCase来获得测试方法。测试类的测试函数要以test_t开头。
有如下常用的测试函数</p>
<pre><code class="language-python">#测试值相等
self.assertEqual(add(0, 0), 0)
#测试是否正确抛出异常
with self.assertRaises(AttributeError):
    value = d.empty
</code></pre>
<p>测试例子如下:</p>
<pre><code class="language-python">#temp.py
def add(a, b):
    return a+b
def sub(a, b):
    return a-b

</code></pre>
<pre><code class="language-python">#temp_test.py
import unittest
from temp import add, sub
class TestTest(unittest.TestCase):

    def test_add(self):
        self.assertEqual(add(1, 2), 3)
        self.assertEqual(add(2, 3), 5)
        self.assertEqual(add(3, 3), 6)
        self.assertEqual(add(4, 3.1), 7.1)
        # self.assertTrue()

    def test_sub(self):
        self.assertEqual(sub(2, 1), 1)

</code></pre>
<p>在vscode中，会自动识别出测试类，下方信息条展示测试情况





  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/3_hub4a9546749a5aa04c7f60ae39f6677ba_14025_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/3_hub4a9546749a5aa04c7f60ae39f6677ba_14025_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="291" height="178">
</a>



</figure>






  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/4_hucee0ddef11194a40fbcef44931b22304_4717_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/4_hucee0ddef11194a40fbcef44931b22304_4717_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="301" height="76">
</a>



</figure>






  
  











<figure>


  <a data-fancybox="" href="/post/python%E7%AC%94%E8%AE%B0/5_hud09bcc991f31bc4a547c0e94ab2884be_3089_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/python%E7%AC%94%E8%AE%B0/5_hud09bcc991f31bc4a547c0e94ab2884be_3089_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="189" height="45">
</a>



</figure>
</p>

    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/&amp;text=python%e7%ac%94%e8%ae%b0" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/&amp;t=python%e7%ac%94%e8%ae%b0" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=python%e7%ac%94%e8%ae%b0&amp;body=https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/&amp;title=python%e7%ac%94%e8%ae%b0" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=python%e7%ac%94%e8%ae%b0%20https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://leidawt.github.io/post/python%E7%AC%94%E8%AE%B0/&amp;title=python%e7%ac%94%e8%ae%b0" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  
    
  
  






  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu59276f0227de022fcb968f70c40fe7c2_22845_270x270_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://leidawt.github.io/">王笑涵</a></h5>
      <h6 class="card-subtitle">博士生</h6>
      <p class="card-text">My research interests include robotics, control.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/leidawt/" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js" integrity="sha256-JEqEejGt4tR35L0a1zodzsV0/PJ6GIf7J4yDtywdrH8=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/cpp.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/java.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/javascript.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"没有找到结果","placeholder":"搜索...","results":"搜索结果"};
      const content_type = {
        'post': "文章",
        'project': "项目",
        'publication' : "出版物",
        'talk' : "演讲"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.0630fec5958cb075a5a38f042b3ddde6.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    Copyright © wxh 2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">引用</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> 复制
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> 下载
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
